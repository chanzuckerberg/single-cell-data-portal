genes_400_count = {
    "ENSG00000185880": "TRIM69",
    "ENSG00000279092": "RP11-1H8.5",
    "ENSG00000185834": "RPL12P4",
    "ENSG00000204262": "COL5A2",
    "ENSG00000143368": "SF3B4",
    "ENSG00000275549": "STPG3-AS1",
    "ENSG00000234425": "RP11-528G1.2",
    "ENSG00000259595": "RP11-516C1.1",
    "ENSG00000269903": "RP11-571M6.18",
    "ENSG00000260698": "RP11-439E19.9",
    "ENSG00000185670": "ZBTB3",
    "ENSG00000068323": "TFE3",
    "ENSG00000065911": "MTHFD2",
    "ENSG00000132464": "ENAM",
    "ENSG00000250771": "RP11-153M7.3",
    "ENSG00000131323": "TRAF3",
    "ENSG00000154764": "WNT7A",
    "ENSG00000259146": "RP1-261D10.2",
    "ENSG00000231731": "AC010976.2",
    "ENSG00000064787": "BCAS1",
    "ENSG00000198873": "GRK5",
    "ENSG00000273374": "RP11-383I23.2",
    "ENSG00000112029": "FBXO5",
    "ENSG00000206192": "ANKRD20A9P",
    "ENSG00000226377": "AC084809.2",
    "ENSG00000076928": "ARHGEF1",
    "ENSG00000260744": "RP11-329J18.3",
    "ENSG00000104812": "GYS1",
    "ENSG00000162385": "MAGOH",
    "ENSG00000206531": "CD200R1L",
    "ENSG00000124588": "NQO2",
    "ENSG00000258689": "LINC01269",
    "ENSG00000273017": "AP000240.9",
    "ENSG00000072163": "LIMS2",
    "ENSG00000170891": "CYTL1",
    "ENSG00000057019": "DCBLD2",
    "ENSG00000234772": "LINC00412",
    "ENSG00000115884": "SDC1",
    "ENSG00000260360": "RP11-533E19.5",
    "ENSG00000146433": "TMEM181",
    "ENSG00000001036": "FUCA2",
    "ENSG00000204936": "CD177",
    "ENSG00000241544": "LINC02029",
    "ENSG00000152894": "PTPRK",
    "ENSG00000279905": "RP11-117L5.1",
    "ENSG00000169100": "SLC25A6_ENSG00000169100",
    "ENSG00000172785": "CBWD1",
    "ENSG00000224957": "LINC01266",
    "ENSG00000260983": "RP11-150D5.2",
    "ENSG00000122218": "COPA",
    "ENSG00000172554": "SNTG2",
    "ENSG00000277210": "RP11-14C10.6",
    "ENSG00000140478": "GOLGA6D",
    "ENSG00000133392": "MYH11",
    "ENSG00000227370": "RP4-669P10.19",
    "ENSG00000215837": "SDHAP2",
    "ENSG00000267243": "AC005307.4",
    "ENSG00000217767": "NDUFAB1P1",
    "ENSG00000250032": "CTD-2194L12.3",
    "ENSG00000199477": "SNORA31",
    "ENSG00000206262": "FOXL2NB",
    "ENSG00000211697": "TRGV5",
    "ENSG00000278668": "RP11-227G15.11",
    "ENSG00000151773": "CCDC122",
    "ENSG00000122035": "RASL11A",
    "ENSG00000184144": "CNTN2",
    "ENSG00000229327": "RP11-135A24.2",
    "ENSG00000106624": "AEBP1",
    "ENSG00000205838": "TTC23L",
    "ENSG00000104375": "STK3",
    "ENSG00000283554": "LINC02341",
    "ENSG00000164151": "ICE1",
    "ENSG00000103932": "RPAP1",
    "ENSG00000095777": "MYO3A",
    "ENSG00000023572": "GLRX2",
    "ENSG00000263105": "RP11-95P2.3",
    "ENSG00000250673": "REELD1",
    "ENSG00000273375": "RP11-803P9.1",
    "ENSG00000147050": "KDM6A",
    "ENSG00000169189": "NSMCE1",
    "ENSG00000271971": "CTD-2006H14.2",
    "ENSG00000253729": "PRKDC",
    "ENSG00000112742": "TTK",
    "ENSG00000249249": "AC010226.4",
    "ENSG00000230555": "RP11-517P14.2",
    "ENSG00000126218": "F10",
    "ENSG00000272430": "LINC02637",
    "ENSG00000165623": "UCMA",
    "ENSG00000168765": "GSTM4",
    "ENSG00000160712": "IL6R",
    "ENSG00000249863": "RP11-177C12.1",
    "ENSG00000163597": "SNHG16",
    "ENSG00000258884": "LINC02321",
    "ENSG00000261716": "H2BC20P",
    "ENSG00000197241": "SLC2A7",
    "ENSG00000261488": "TBILA",
    "ENSG00000236318": "LINC02888",
    "ENSG00000125656": "CLPP",
    "ENSG00000128918": "ALDH1A2",
    "ENSG00000184588": "PDE4B",
    "ENSG00000186827": "TNFRSF4",
    "ENSG00000241413": "RN7SL441P",
    "ENSG00000124549": "BTN2A3P",
    "ENSG00000125450": "NUP85",
    "ENSG00000023228": "NDUFS1",
    "ENSG00000120820": "GLT8D2",
    "ENSG00000260850": "RP11-437L7.1",
    "ENSG00000165512": "ZNF22",
    "ENSG00000272768": "RP4-673M15.1",
    "ENSG00000164933": "SLC25A32",
    "ENSG00000158987": "RAPGEF6",
    "ENSG00000228541": "AC093159.1",
    "ENSG00000018699": "TTC27",
    "ENSG00000206199": "ANKUB1",
    "ENSG00000140832": "MARVELD3",
    "ENSG00000164124": "TMEM144",
    "ENSG00000173124": "ACSM6",
    "ENSG00000140694": "PARN",
    "ENSG00000267501": "RP11-108P20.2",
    "ENSG00000253161": "LINC01605_ENSG00000253161",
    "ENSG00000244953": "RP11-613D13.8",
    "ENSG00000100311": "PDGFB",
    "ENSG00000258949": "RP11-857B24.5",
    "ENSG00000248909": "HMGB1P21",
    "ENSG00000278017": "RP11-120K19.4",
    "ENSG00000238098": "ABCA17P",
    "ENSG00000198331": "HYLS1",
    "ENSG00000124701": "APOBEC2",
    "ENSG00000271500": "RP11-288K12.1",
    "ENSG00000276950": "GSTT4",
    "ENSG00000198586": "TLK1",
    "ENSG00000248752": "RP11-114J13.1",
    "ENSG00000175426": "PCSK1",
    "ENSG00000188897": "CTD-3088G3.8",
    "ENSG00000177721": "ANXA2R",
    "ENSG00000228786": "LINC00266-4P",
    "ENSG00000237387": "CTA-407F11.7",
    "ENSG00000273687": "RP5-837J1.6",
    "ENSG00000279744": "RP13-20L14.10",
    "ENSG00000285373": "LINC02478",
    "ENSG00000225870": "LINC00368",
    "ENSG00000272123": "CTD-2366F13.2",
    "ENSG00000274933": "TBC1D3I",
    "ENSG00000211776": "TRAV2",
    "ENSG00000241411": "RP11-192C21.1",
    "ENSG00000169551": "CT55",
    "ENSG00000129951": "PLPPR3",
    "ENSG00000221819": "GAS8-AS1",
    "ENSG00000180438": "TPRXL",
    "ENSG00000237714": "P4HA2-AS1",
    "ENSG00000284646": "RP4-796F18.3",
    "ENSG00000276975": "HYDIN2",
    "ENSG00000224222": "LINC02636",
    "ENSG00000201901": "RN7SKP48",
    "ENSG00000229356": "LRRC3-DT",
    "ENSG00000175894": "TSPEAR",
    "ENSG00000254734": "CTD-3138F19.1",
    "ENSG00000271390": "RP11-89C3.3",
    "ENSG00000225458": "RP5-1121H13.4",
    "ENSG00000272232": "RN7SL726P",
    "ENSG00000283881": "MIR3916",
    "ENSG00000273493": "RP11-80H18.4",
    "ENSG00000250969": "RP11-364L4.3",
    "ENSG00000249458": "RP11-624A4.1",
    "ENSG00000233535": "RP1-122K4.2",
    "ENSG00000279897": "BIRC6-AS2",
    "ENSG00000258861": "MIR381HG",
    "ENSG00000233932": "CTXN2",
    "ENSG00000235010": "RP11-140A10.3",
    "ENSG00000279530": "RP11-398J13.1",
    "ENSG00000277702": "CH17-13I23.3",
    "ENSG00000271099": "RP11-809N15.3",
    "ENSG00000177938": "CAPZA3",
    "ENSG00000200683": "RNU6-379P",
    "ENSG00000285999": "AC025442.4",
    "ENSG00000254897": "RP11-482L11.1",
    "ENSG00000243385": "CTD-2110K23.1",
    "ENSG00000241738": "ZNF90P1",
    "ENSG00000259856": "RAB43P1",
    "ENSG00000207117": "Y_RNA_ENSG00000207117",
    "ENSG00000250444": "CCT5P1",
    "ENSG00000226926": "PDZPH1P",
    "ENSG00000223916": "RP11-353H3.1",
    "ENSG00000284128": "BCRP3_ENSG00000284128",
    "ENSG00000259394": "RP11-244F12.1",
    "ENSG00000200959": "SNORA74A",
    "ENSG00000226268": "RP11-61N20.3",
    "ENSG00000266648": "SETP3",
    "ENSG00000225982": "RP11-538D16.3",
    "ENSG00000265298": "RP13-104F24.3",
    "ENSG00000256616": "RP11-815J4.6",
    "ENSG00000223558": "TRIM60P17",
    "ENSG00000261278": "RP11-430C1.2",
    "ENSG00000253793": "RP11-293D9.2",
    "ENSG00000242411": "CTD-2086L14.1",
    "ENSG00000197084": "LCE1C",
    "ENSG00000237991": "RPL35P1",
    "ENSG00000284902": "RP11-582H21.1",
    "ENSG00000225496": "RTRAFP1",
    "ENSG00000225169": "BRI3P1",
    "ENSG00000176246": "OR4L1",
    "ENSG00000224121": "ATG12P2",
    "ENSG00000272689": "RP4-539M6.21",
    "ENSG00000204246": "OR13C3",
    "ENSG00000222267": "RNU6-892P",
    "ENSG00000280183": "RP11-400F19.12",
    "ENSG00000254176": "IGHV3-75",
    "ENSG00000252743": "RNU6-850P",
    "ENSG00000237433": "RPSAP11",
    "ENSG00000217094": "PPIAP31",
    "ENSG00000207166": "SNORA68",
    "ENSG00000188525": "AC010969.1",
    "ENSG00000223202": "RN7SKP297",
    "ENSG00000261678": "SCRT1",
    "ENSG00000243141": "RPL23AP66",
    "ENSG00000279149": "RP11-374F3.5",
    "ENSG00000231857": "MORF4L1P5",
    "ENSG00000226230": "AC007237.2",
    "ENSG00000249139": "EPPIN-WFDC6",
    "ENSG00000233033": "CASK-AS1",
    "ENSG00000228653": "HNRNPCP7",
    "ENSG00000267232": "CTB-31O20.9",
    "ENSG00000199400": "RNY4P19",
    "ENSG00000237265": "RP11-402P6.9",
    "ENSG00000253993": "RP11-451O18.1",
    "ENSG00000232398": "TMPRSS11CP",
    "ENSG00000213302": "RP11-560I19.2",
    "ENSG00000279461": "RP4-592G7.5",
    "ENSG00000235424": "SUMO2P10",
    "ENSG00000239661": "RP11-78O22.1",
    "ENSG00000233063": "SAR1AP4",
    "ENSG00000215357": "HSPD1P8",
    "ENSG00000215065": "DUSP8P1",
    "ENSG00000201999": "RNA5SP428",
    "ENSG00000232174": "CTB-164L20.1",
    "ENSG00000213701": "SETP22",
    "ENSG00000230040": "LINC00364",
    "ENSG00000266195": "RN7SL163P",
    "ENSG00000243355": "RP11-57G22.1",
    "ENSG00000270435": "RP11-304C12.4",
    "ENSG00000238485": "ENSG10010135828.1",
    "ENSG00000265141": "RN7SL451P",
    "ENSG00000229002": "RP11-666A1.4",
    "ENSG00000226289": "CDCA4P3",
    "ENSG00000135698": "MPHOSPH6",
    "ENSG00000117569": "PTBP2",
    "ENSG00000131378": "RFTN1",
    "ENSG00000152409": "JMY",
    "ENSG00000120708": "TGFBI",
    "ENSG00000159692": "CTBP1",
    "ENSG00000103657": "HERC1",
    "ENSG00000204219": "TCEA3",
    "ENSG00000121594": "CD80",
    "ENSG00000070778": "PTPN21",
    "ENSG00000114302": "PRKAR2A",
    "ENSG00000145349": "CAMK2D",
    "ENSG00000145908": "ZNF300",
    "ENSG00000163798": "SLC4A1AP",
    "ENSG00000181585": "TMIE",
    "ENSG00000172336": "POP7",
    "ENSG00000137962": "ARHGAP29",
    "ENSG00000127603": "MACF1",
    "ENSG00000121440": "PDZRN3",
    "ENSG00000183475": "ASB7",
    "ENSG00000187808": "SOWAHD",
    "ENSG00000150630": "VEGFC",
    "ENSG00000197586": "ENTPD6",
    "ENSG00000121769": "FABP3",
    "ENSG00000113845": "TIMMDC1",
    "ENSG00000148187": "MRRF",
    "ENSG00000169696": "ASPSCR1",
    "ENSG00000115756": "HPCAL1",
    "ENSG00000186188": "FFAR4",
    "ENSG00000109089": "CDR2L",
    "ENSG00000065029": "ZNF76",
    "ENSG00000139684": "ESD",
    "ENSG00000163818": "LZTFL1",
    "ENSG00000166598": "HSP90B1",
    "ENSG00000165271": "NOL6",
    "ENSG00000148450": "MSRB2",
    "ENSG00000101096": "NFATC2",
    "ENSG00000107771": "CCSER2",
    "ENSG00000089225": "TBX5",
    "ENSG00000117676": "RPS6KA1",
    "ENSG00000120885": "CLU",
    "ENSG00000173269": "MMRN2",
    "ENSG00000052802": "MSMO1",
    "ENSG00000117614": "SYF2",
    "ENSG00000153339": "TRAPPC8",
    "ENSG00000110218": "PANX1",
    "ENSG00000140463": "BBS4",
    "ENSG00000071054": "MAP4K4",
    "ENSG00000161021": "MAML1",
    "ENSG00000234899": "SOX9-AS1",
    "ENSG00000254162": "RP11-48B3.3",
    "ENSG00000243696": "RP5-966M1.6",
    "ENSG00000280425": "RP11-446E24.3",
    "ENSG00000106125": "MINDY4",
    "ENSG00000225465": "RFPL1S",
    "ENSG00000203907": "OOEP",
    "ENSG00000258979": "LINC02299",
    "ENSG00000241015": "TPM3P9",
    "ENSG00000122390": "NAA60",
    "ENSG00000266509": "MIR3934",
    "ENSG00000277301": "RP5-1184F4.7",
    "ENSG00000101405": "OXT",
    "ENSG00000222588": "ENSG10010140089.1",
    "ENSG00000199695": "RNU6-1128P",
    "ENSG00000248599": "FLJ42969",
    "ENSG00000128965": "CHAC1",
    "ENSG00000229671": "LINC01150",
    "ENSG00000145029": "NICN1",
    "ENSG00000244055": "AC007566.10",
    "ENSG00000160062": "ZBTB8A",
    "ENSG00000270022": "RNU12_ENSG00000270022",
    "ENSG00000243538": "RPS26P28",
    "ENSG00000237264": "FTH1P11",
    "ENSG00000155816": "FMN2",
    "ENSG00000199591": "Y_RNA_ENSG00000199591",
    "ENSG00000268129": "RP11-91G21.1",
    "ENSG00000130948": "HSD17B3",
    "ENSG00000198765": "SYCP1",
    "ENSG00000273710": "Metazoa_SRP_ENSG00000273710",
    "ENSG00000273007": "RP11-170N16.3",
    "ENSG00000256152": "RP11-463O12.3",
    "ENSG00000232177": "MTND4P24",
    "ENSG00000265261": "RP11-162A12.3",
    "ENSG00000102010": "BMX",
    "ENSG00000279033": "RP11-500C12.1",
    "ENSG00000270025": "BMS1P7",
    "ENSG00000134460": "IL2RA",
    "ENSG00000256571": "RP11-274J7.2",
    "ENSG00000178568": "ERBB4",
    "ENSG00000150764": "DIXDC1",
    "ENSG00000183281": "PLGLB1",
    "ENSG00000203416": "FAM32BP",
    "ENSG00000270277": "RP11-65L3.2",
    "ENSG00000239483": "RPS15AP16",
    "ENSG00000274168": "RN7SL585P",
    "ENSG00000204019": "CT83",
    "ENSG00000280239": "CTB-50L17.8",
    "ENSG00000233967": "RP11-250B2.3",
    "ENSG00000226884": "RPS29P10",
    "ENSG00000174680": "GRIK1-AS1",
    "ENSG00000246560": "UBE2D3-AS1",
    "ENSG00000224157": "HCG14",
    "ENSG00000201581": "RN7SKP78",
    "ENSG00000275191": "RP11-36I17.2",
    "ENSG00000261480": "GOLGA8M_ENSG00000261480",
    "ENSG00000241281": "RP11-364M6.1",
    "ENSG00000183379": "SYNDIG1L",
    "ENSG00000234793": "AC114730.7",
    "ENSG00000279122": "RP11-394B2.3",
    "ENSG00000225973": "PIGBOS1",
    "ENSG00000132680": "KHDC4",
    "ENSG00000251136": "RP11-37B2.1",
    "ENSG00000272288": "ILRUN-AS1",
    "ENSG00000259792": "RP11-114H24.6",
    "ENSG00000248027": "ARHGAP42-AS1",
    "ENSG00000241494": "RP11-796G6.1",
    "ENSG00000232233": "LINC02043",
    "ENSG00000279827": "RP11-886P16.10",
    "ENSG00000285407": "RP11-520E6.1",
    "ENSG00000198570": "RD3",
    "ENSG00000230499": "AC108463.1",
    "ENSG00000228944": "AC004485.3",
    "ENSG00000228566": "RP11-170M17.1",
    "ENSG00000228842": "PCDH9-AS2",
    "ENSG00000266450": "CTD-2015H3.2",
    "ENSG00000148798": "INA",
    "ENSG00000108018": "SORCS1",
    "ENSG00000264924": "RP11-799B12.2",
    "ENSG00000263724": "DLGAP1-AS3",
    "ENSG00000283457": "RP11-53L24.2",
    "ENSG00000230876": "LINC00486_ENSG00000230876",
    "ENSG00000267261": "CTD-2132N18.3",
    "ENSG00000283347": "RP11-569D9.6",
    "ENSG00000256343": "RP11-662M24.1",
    "ENSG00000260937": "RP11-548M13.1",
    "ENSG00000238243": "OR2W3",
    "ENSG00000284702": "RP4-534N18.4",
    "ENSG00000281849": "RP13-465B17.4_ENSG00000281849",
    "ENSG00000177679": "SRRM3",
    "ENSG00000164256": "PRDM9",
    "ENSG00000260616": "RP11-327F22.4",
    "ENSG00000249773": "RP11-15K19.2",
    "ENSG00000198398": "TMEM207",
    "ENSG00000258779": "LINC01568",
    "ENSG00000235890": "TSPEAR-AS1",
    "ENSG00000163530": "DPPA2",
    "ENSG00000233684": "LINC01865",
    "ENSG00000155886": "SLC24A2",
    "ENSG00000211819": "TRAV40",
    "ENSG00000111046": "MYF6",
    "ENSG00000234572": "LINC01800",
    "ENSG00000256440": "RP11-443N24.3",
    "ENSG00000210151": "MT-TS1",
    "ENSG00000203334": "RP11-25I9.3",
    "ENSG00000254820": "CTD-2019O4.1",
    "ENSG00000252213": "SNORA74D",
}

genes_20_count = {
    "ENSG00000227295": "ELL2P1",
    "ENSG00000229638": "RPL4P4",
    "ENSG00000286039": "RP11-489G11.4",
    "ENSG00000257037": "RARS1P1",
    "ENSG00000242067": "RPL9P28",
    "ENSG00000285238": "RP5-940J5.10",
    "ENSG00000253584": "CTD-2374C24.1",
    "ENSG00000252220": "RNU6-977P",
    "ENSG00000248459": "RP11-93K22.1",
    "ENSG00000232715": "LINC01022",
    "ENSG00000252156": "RNU6-155P",
    "ENSG00000237897": "RP11-90H3.2",
    "ENSG00000240864": "IGKV1-16",
    "ENSG00000211826": "TRDJ4",
    "ENSG00000179407": "DNAJB8",
    "ENSG00000176219": "OR11H6",
    "ENSG00000285191": "RP11-80O3.1",
    "ENSG00000235152": "RP5-865N13.2",
    "ENSG00000182083": "OR6B2",
    "ENSG00000183753": "BPY2",
}

tissues_with_30_plus_cell_types = {
    "UBERON:0002048": "lung",
    "UBERON:0000178": "blood",
    "UBERON:0000029": "lymph node",
    "UBERON:0000970": "eye",
    "UBERON:0000362": "renal medulla",
    "UBERON:0001707": "nasal cavity",
}
secondary_filter_common_case_request_data = {
    "filter": {
        "dataset_ids": [],
        "disease_ontology_term_ids": ["MONDO:0005812", "MONDO:0100096", "PATO:0000461"],
        "gene_ontology_term_ids": list(genes_20_count.keys()),
        "organism_ontology_term_id": "NCBITaxon:9606",
        "sex_ontology_term_ids": ["PATO:0000383"],
        "tissue_ontology_term_ids": ["UBERON:0000178"],
    },  # blood (more than 50 cell types)
}

secondary_filter_extreme_case_request_data = {
    "filter": {
        "dataset_ids": [],
        "disease_ontology_term_ids": [],
        "self_reported_ethnicity_ontology_term_ids": [],
        "gene_ontology_term_ids": list(genes_400_count.keys()),
        "organism_ontology_term_id": "NCBITaxon:9606",
        "sex_ontology_term_ids": [],
        "tissue_ontology_term_ids": [
            "UBERON:0000178",
            "UBERON:0002048",
            "UBERON:0000029",
            "UBERON:0000970",
            "UBERON:0000362",
        ],
    },
}

secondary_filter_data_with_ontology_term_ids = {
    "filter": {
        "dataset_ids": [],
        "disease_ontology_term_ids": ["MONDO:0005812", "MONDO:0100096", "PATO:0000461"],
        "gene_ontology_term_ids": list(genes_20_count.keys()),
        "organism_ontology_term_id": "NCBITaxon:9606",
        "sex_ontology_term_ids": ["PATO:0000383"],
        "tissue_ontology_term_ids": ["UBERON:0000178"],
        "cell_type_ontology_term_ids": ["CL:0000010"],
    },
}

markers_happy_path = {
    "celltype": "UBERON:0002048",
    "organism": "NCBITaxon:9606",
    "tissue": "UBERON:0000178",
    "n_markers": 10,
    "test": "ttest",
}

markers_missing_tissue = {
    "celltype": "UBERON:0002048",
    "organism": "NCBITaxon:9606",
    "n_markers": 10,
    "test": "ttest",
}
